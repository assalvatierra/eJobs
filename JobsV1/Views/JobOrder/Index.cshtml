@model IEnumerable<JobsV1.Controllers.cJobOrder>

@{
    ViewBag.Title = "Work in Progress";
}

<h2>Job Orders</h2>

<p>
    @Html.ActionLink("Create New", "jobCreate",null,null) 
    | Work In Progress 
    | @Html.ActionLink("Job Table", "JobTable", "JobMains", new { span = 30 }, null) 
    | @Html.ActionLink("Availability", "Availability", "InvItems")
</p>

<table class="table">

@foreach (var item in Model) {
    <tr>
        <td>
            <div style="background-color:lightgray;text-align:center;">
                <span style="color:darkblue; font: bold 12px arial, verdana;">@item.Main.JobDate.ToString("MMM-yyyy")</span>
                <br /><span style="color:blue; font: bold 28px arial, verdana;">@item.Main.JobDate.ToString("dd")</span>
                <span style="color:blue; font: bold 12px arial, verdana;">(@item.Main.JobDate.ToString("ddd"))</span>
                <br /><br /><span style="color:red; font: normal 18px arial, verdana;">&nbsp;</span>
            </div>
        </td>

        <td>
            <div style="background-color:lightgray;">
                @foreach (var cntrTmp in item.ActionCounter)
                {
                    if (cntrTmp.CodeId != null)
                    {
                        string fColor = (cntrTmp.CntItem <= cntrTmp.CntDone ? "darkorange" : "gray");
                    <span style="color:darkorange">&#187;</span>
                    <span style="font-weight:500; color: @fColor">
                        @cntrTmp.CodeDesc
                    </span>  
                    }
                }
            </div>

            <div>
                <span style="color:darkgreen;font:bold 16px arial, verdana;">
                    @item.Main.Customer.Name
                </span>
                [
                @Html.ActionLink("Customer Details", "CompanyDetail", new { jobid = item.Main.Id, custid = item.Main.CustomerId}) |
                @Html.ActionLink("Job Details", "JobDetails", new { jobid = item.Main.Id }) |    
                <!--
                Html.ActionLink("Change Company", "ChangeCompany", "JobOrder",new { jobid = item.Main.Id }, new { data-toggle = "modal", data-target = "#SupplierPoItemsModal" })                
                -->

                <a href="#" id="catbtn" data-toggle="modal" data-target="#@item.Main.Id" style="margin-bottom:10px;">Edit Company</a>
                ]

            </div>
            <div>
                @Html.Partial("PartialViewServiceList", item.Services)
            </div>

            @Html.ActionLink("[ Add New Service ]", "JobServiceAdd", new { JobMainId = item.Main.Id }, null)
        </td>
    </tr>


    <!-- Modal -->
    <div class="modal fade" id="@item.Main.Id" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Company List</h4>
                </div>

                <div class="modal-body" id="modal2-content">

                    <div class="list-group" id="categorylist">

                        @foreach (var list in ViewBag.companyList as IEnumerable<JobsV1.Models.Customer>)
                        {
                            <a href="@Url.Action("ChangeCompany", "JobOrder", new { id = @item.Main.Id, newId = @list.Id },null)" class="list-group-item"> @list.Name</a>
                        }
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
}

</table>

@Html.Partial("PartialViewJS")

@section scripts
{
    <script type="text/javascript">
        $(document).ready(function () {
            initialize();
        });

    </script>

}
